[{"content":"UMLç±»å›¾å…³ç³» ğŸ’¡ UML å…¨ç§°Unified Modeling Language, ç»Ÿè®¡å»ºæ¨¡è¯­è¨€.\nUMLç±»å›¾ä¸­æœ‰å…­ç§å…³ç³»ï¼Œä»å¼±åˆ°å¼ºä¾æ¬¡æ˜¯ï¼š\nä¾èµ–å…³ç³» \u0026lt; å…³è”å…³ç³» \u0026lt; èšåˆå…³ç³» \u0026lt; ç»„åˆå…³ç³» \u0026lt; å®ç°å…³ç³» = æ³›åŒ–å…³ç³»\nç±»çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•å‰é¢çš„ä¿®é¥°ç¬¦æœ‰public, private, protected, defaultï¼Œåœ¨UMLç±»å›¾ä¸­åˆ†åˆ«ç”¨ +, -, #, ~è¡¨ç¤ºã€‚\n1. ä¾èµ–å…³ç³» é€šç”¨æè¿°: ä¾èµ–å…³ç³»è¡¨ç¤ºæŸä¸ªç±»ä¾èµ–äºå¦å¤–ä¸€ä¸ªç±»\nä»£ç è¡¨ç°: æŸä¸ªç±»çš„æ–¹æ³•çš„å‚æ•°ä½¿ç”¨äº†å¦å¤–ä¸€ä¸ªç±»çš„å¯¹è±¡\nç®­å¤´æè¿°: ä¾èµ–å…³ç³»ä½¿ç”¨å¸¦ç®­å¤´çš„è™šçº¿è¡¨ç¤º, ç®­å¤´æŒ‡å‘è¢«ä¾èµ–çš„ç±»\nç¤ºä¾‹å›¾æ ·:\n2. å…³è”å…³ç³» é€šç”¨æè¿°: å…³è”å…³ç³»è¡¨ç¤ºä¸€ä¸ªç±»å’Œå¦å¤–ä¸€ä¸ªç±»çš„è”ç³», å¦‚è€å¸ˆå’Œå­¦ç”Ÿ\nä»£ç è¡¨ç°: æŸä¸ªç±»çš„æˆå‘˜å˜é‡æ˜¯å¦å¤–ä¸€ä¸ªç±»çš„å¯¹è±¡\nç®­å¤´æè¿°: ä¾èµ–å…³ç³»æœ‰å•å‘å’ŒåŒå‘, å•å‘ä½¿ç”¨å¸¦ç®­å¤´çš„å®çº¿è¡¨ç¤º, ç®­å¤´æŒ‡å‘è¢«å…³è”çš„ç±», åŒå‘ä½¿ç”¨åŒç®­å¤´æˆ–è€…æ²¡æœ‰ç®­å¤´çš„å®çº¿è¡¨ç¤º.\nç¤ºä¾‹å›¾æ ·:\n3. èšåˆå…³ç³» é€šç”¨æè¿°: èšåˆå…³ç³»æ˜¯å…³è”å…³ç³»çš„ä¸€ç§, è¡¨ç¤ºçš„æ˜¯æ•´ä½“ä¸éƒ¨åˆ†ä¹‹é—´çš„å…³ç³», å¦‚å­¦æ ¡å’Œè€å¸ˆ, è½¦å­å’Œè½®èƒ\nä»£ç è¡¨ç°: æŸä¸ªç±»çš„æˆå‘˜å˜é‡æ˜¯å¦å¤–ä¸€ä¸ªç±»çš„å¯¹è±¡\nç®­å¤´æè¿°: èšåˆå…³ç³»ä½¿ç”¨å¸¦ç©ºå¿ƒè±å½¢çš„å®çº¿è¡¨ç¤º, è±å½¢æŒ‡å‘æ•´ä½“\nç¤ºä¾‹å›¾æ ·:\n4. ç»„åˆå…³ç³» é€šç”¨æè¿°: ç»„åˆå…³ç³»æ˜¯å…³è”å…³ç³»çš„ä¸€ç§, æ˜¯ä¸€ç§æ¯”èšåˆå…³ç³»æ›´å¼ºçš„ä¸€ç§å…³ç³», éƒ¨åˆ†ä¸èƒ½è„±ç¦»æ•´ä½“è€Œå•ç‹¬å­˜åœ¨, å¦‚èº«ä½“å’Œå¤§è„‘\nä»£ç è¡¨ç°: æŸä¸ªç±»çš„æˆå‘˜å˜é‡æ˜¯å¦å¤–ä¸€ä¸ªç±»çš„å¯¹è±¡\nç®­å¤´æè¿°: ç»„åˆå…³ç³»ä½¿ç”¨å¸¦å®å¿ƒè±å½¢çš„å®çº¿è¡¨ç¤º, è±å½¢æŒ‡å‘æ•´ä½“\nç¤ºä¾‹å›¾æ ·:\n5. å®ç°å…³ç³» é€šç”¨æè¿°: å®ç°å…³ç³»æ˜¯æ¥å£å’Œå®ç°ç±»ä¹‹é—´çš„å…³ç³»\nä»£ç è¡¨ç°: æ¥å£å’Œå®ç°ç±»\nç®­å¤´æè¿°: å®ç°å…³ç³»ä½¿ç”¨å¸¦ç©ºå¿ƒä¸‰è§’ç®­å¤´çš„è™šçº¿è¡¨ç¤º, ç®­å¤´æŒ‡å‘æ¥å£\nç¤ºä¾‹å›¾æ ·:\n6. æ³›åŒ–å…³ç³» é€šç”¨æè¿°: æ³›åŒ–å…³ç³»æ˜¯çˆ¶å­ç±»ä¹‹é—´çš„ç»§æ‰¿å…³ç³»\nä»£ç è¡¨ç°: æŠ½è±¡çˆ¶å­ä¸å­ç±», ç»§æ‰¿\nç®­å¤´æè¿°: æ³›åŒ–å…³ç³»ä½¿ç”¨å¸¦ç©ºå¿ƒä¸‰è§’ç®­å¤´çš„å®çº¿æ¥è¡¨ç¤º, ç®­å¤´æŒ‡å‘çˆ¶ç±»\nç¤ºä¾‹å›¾æ ·:\næ€»ç»“ ä¾èµ–å…³ç³» \u0026lt; å…³è”å…³ç³» \u0026lt; èšåˆå…³ç³» \u0026lt; ç»„åˆå…³ç³» \u0026lt; å®ç°å…³ç³» = æ³›åŒ–å…³ç³» å…³ç³»åç§° ä»£ç è¡¨ç° ç®­å¤´å½¢å¼ ç®­å¤´æŒ‡å‘ ä¾èµ–å…³ç³» æ–¹æ³•å‚æ•° è™šçº¿ç®­å¤´ æŒ‡å‘è¢«ä¾èµ–çš„ç±»(æ–¹æ³•å‚æ•°çš„ç±») å…³è”å…³ç³» æˆå‘˜å˜é‡ å®çº¿ç®­å¤´ æŒ‡å‘è¢«å…³è”çš„ç±»(æˆå‘˜å˜é‡çš„ç±») èšåˆå…³ç³» æˆå‘˜å˜é‡ å®çº¿ç©ºå¿ƒè±å½¢ æŒ‡å‘æ•´ä½“ ç»„åˆå…³ç³» æˆå‘˜å˜é‡ å®çº¿å®å¿ƒè±å½¢ æŒ‡å‘æ•´ä½“ å®ç°å…³ç³» æ¥å£ä¸å®ç°ç±» è™šçº¿ç©ºå¿ƒä¸‰è§’ æŒ‡å‘æ¥å£ æ³›åŒ–å…³ç³» æŠ½è±¡çˆ¶ç±»ä¸å­ç±» å®çº¿ç©ºå¿ƒä¸‰è§’ æŒ‡å‘çˆ¶ç±» ","permalink":"https://habyss.github.io/posts/tech/uml/","summary":"UMLç±»å›¾å…³ç³» ğŸ’¡ UML å…¨ç§°Unified Modeling Language, ç»Ÿè®¡å»ºæ¨¡è¯­è¨€. UMLç±»å›¾ä¸­æœ‰å…­ç§å…³ç³»ï¼Œä»å¼±åˆ°å¼ºä¾æ¬¡æ˜¯ï¼š ä¾èµ–å…³ç³» \u0026lt; å…³è”å…³ç³» \u0026lt; èšåˆå…³ç³» \u0026lt; ç»„åˆå…³ç³» \u0026lt; å®ç°å…³","title":"UMLç±»å›¾å…³ç³»"},{"content":"@Transactionalå¤±æ•ˆ æ•´åˆshiroä¹‹åï¼ŒUserRealmç±»é‡Œè‡ªåŠ¨æ³¨å…¥çš„serviceä¸­çš„@Transactionalæ³¨è§£å¤±æ•ˆ\nè§£å†³æ–¹æ³• ä½¿ç”¨@Lazyæ³¨è§£\n1 2 3 @Autowired @Lazy private OperationUnitService operationUnitService; åœ¨Realmä¸­ç›´æ¥ä½¿ç”¨mapperï¼Œè€Œä¸æ˜¯service\n1 2 @Autowired private OperationUnitMapper operationUnitMapper; ApplicationContextRegister.getBean()æ–¹æ³•ï¼Œæ‰‹åŠ¨æ³¨å…¥bean\n1 OperationUnitService operationUnitService = ApplicationContextRegister.getBean(OperationUnitService.class) äº§ç”ŸåŸå›  åœ¨shiroä¸­ä¸ºäº†å¼•å…¥æƒé™æ³¨è§£ï¼Œé…ç½®äº†defaultAdvisorAutoProxyCreatorå’ŒauthorizationAttributeSourceAdvisorç±»ï¼Œä»–ä»¬æ˜¯é€šè¿‡AOPæ–¹å¼å¯¹@RequiredPermissionç±»/æ–¹æ³•(æƒé™æ§åˆ¶)è¿›è¡Œå¢å¼º.\nç”Ÿæˆå¯¹åº”çš„ä»£ç†ç±»å¯¹è±¡ï¼Œç”±äºshiroFilterFactoryBeanå®ç°äº†factoryBeanæ¥å£ï¼Œæ‰€ä»¥ä¼šè¢«æå‰åˆå§‹åŒ–ï¼Œæ‰€ä»¥å¼•å‘æ‰€æœ‰ç›¸å…³çš„beanæå‰åˆå§‹åŒ–ï¼Œå¯¼è‡´ä»–ä»¬æ²¡æœ‰è¢«äº‹åŠ¡AOPåŒ…è£¹ç€ï¼Œä»è€Œå¼•å‘äº‹åŠ¡æ— æ•ˆçš„é—®é¢˜\n1 2 3 4 5 6 7 8 9 10 11 /** * å¼€å¯Shiroçš„æ³¨è§£(å¦‚@RequiresRoles,@RequiresPermissions),éœ€å€ŸåŠ©SpringAOPæ‰«æä½¿ç”¨Shiroæ³¨è§£çš„ç±»,å¹¶åœ¨å¿…è¦æ—¶è¿›è¡Œå®‰å…¨é€»è¾‘éªŒè¯ * é…ç½®ä»¥ä¸‹ä¸¤ä¸ªbean(DefaultAdvisorAutoProxyCreator(å¯é€‰)å’ŒAuthorizationAttributeSourceAdvisor)å³å¯å®ç°æ­¤åŠŸèƒ½ */ @Bean @DependsOn({\u0026#34;lifecycleBeanPostProcessor\u0026#34;}) public DefaultAdvisorAutoProxyCreator advisorAutoProxyCreator() { DefaultAdvisorAutoProxyCreator advisorAutoProxyCreator = new DefaultAdvisorAutoProxyCreator(); advisorAutoProxyCreator.setProxyTargetClass(true); return advisorAutoProxyCreator; } å…ƒç´ çš„ \u0026ldquo;proxy-target-class\u0026rdquo; å±æ€§å€¼æ¥æ§åˆ¶æ˜¯åŸºäºæ¥å£çš„è¿˜æ˜¯åŸºäºç±»çš„ä»£ç†è¢«åˆ›å»ºã€‚å¦‚æœ \u0026ldquo;proxy-target-class\u0026rdquo; å±å€¼è¢«è®¾ç½®ä¸º \u0026ldquo;true\u0026rdquo;ï¼Œé‚£ä¹ˆåŸºäºç±»çš„ä»£ç†å°†èµ·ä½œç”¨ï¼ˆè¿™æ—¶éœ€è¦CGLIBåº“cglib.jaråœ¨CLASSPATHä¸­ï¼‰ã€‚å¦‚æœ \u0026ldquo;proxy-target-class\u0026rdquo; å±å€¼è¢«è®¾ç½®ä¸º \u0026ldquo;false\u0026rdquo; æˆ–è€…è¿™ä¸ªå±æ€§è¢«çœç•¥ï¼Œé‚£ä¹ˆæ ‡å‡†çš„JDKåŸºäºæ¥å£çš„ä»£ç†å°†èµ·ä½œç”¨ã€‚\nå·¥å…· å¿«æ·æŸ¥çœ‹äº‹åŠ¡æ˜¯å¦ç”Ÿæ•ˆ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 public class DebugUtils { private static final boolean transactionDebugging = true; private static final boolean verboseTransactionDebugging = true; public static void showTransactionStatus(String message) { System.out.println(((transactionActive()) ? \u0026#34;[+] \u0026#34; : \u0026#34;[-] \u0026#34;) + message); } // Some guidance from: \u0026lt;http://java.dzone.com/articles/monitoring-declarative-transac?page=0,1\u0026gt; public static boolean transactionActive() { try { ClassLoader contextClassLoader = Thread.currentThread().getContextClassLoader(); Class tsmClass = contextClassLoader.loadClass(\u0026#34;org.springframework.transaction.support.TransactionSynchronizationManager\u0026#34;); Boolean isActive = (Boolean) tsmClass.getMethod(\u0026#34;isActualTransactionActive\u0026#34;, null).invoke(null, null); return isActive; } catch (ClassNotFoundException e) { e.printStackTrace(); } catch (IllegalArgumentException e) { e.printStackTrace(); } catch (SecurityException e) { e.printStackTrace(); } catch (IllegalAccessException e) { e.printStackTrace(); } catch (InvocationTargetException e) { e.printStackTrace(); } catch (NoSuchMethodException e) { e.printStackTrace(); } // If we got here it means there was an exception throw new IllegalStateException(\u0026#34;ServerUtils.transactionActive was unable to complete properly\u0026#34;); } public static void transactionRequired(String message) { // Are we debugging transactions? if (!transactionDebugging) { // No, just return return; } // Are we doing verbose transaction debugging? if (verboseTransactionDebugging) { // Yes, show the status before we get to the possibility of throwing an exception showTransactionStatus(message); } // Is there a transaction active? if (!transactionActive()) { // No, throw an exception throw new IllegalStateException(\u0026#34;Transaction required but not active [\u0026#34; + message + \u0026#34;]\u0026#34;); } } } åœ¨éœ€è¦æ£€æµ‹çš„åœ°æ–¹\n1 DebugUtils.transactionRequired(\u0026#34;OperationUnitServiceImpl.testIn\u0026#34;); ","permalink":"https://habyss.github.io/posts/tech/transactional/","summary":"@Transactionalå¤±æ•ˆ æ•´åˆshiroä¹‹åï¼ŒUserRealmç±»é‡Œè‡ªåŠ¨æ³¨å…¥çš„serviceä¸­çš„@Transactionalæ³¨è§£å¤±æ•ˆ è§£","title":"@Transactionalå¤±æ•ˆæ’æŸ¥"},{"content":"$ref-fastjson é—®é¢˜æ’æŸ¥ é—®é¢˜æ’æŸ¥ é¡¹ç›®è¿”å›çš„æ•°æ®ä¸­å‡ºç°$refæ•°æ®\næŸ¥è¯¢å¾—çŸ¥æ˜¯fastjsonçš„ç‰¹æ€§å¾ªç¯å¼•ç”¨ fastjsonæ”¯æŒå¾ªç¯å¼•ç”¨ï¼Œå¹¶ä¸”æ˜¯ç¼ºçœæ‰“å¼€çš„ã€‚\nå½“åºåˆ—åŒ–åçš„JSONä¼ è¾“åˆ°æµè§ˆå™¨æˆ–è€…å…¶ä»–è¯­è¨€ä¸­ï¼Œè¿™äº›jsonè§£æå™¨ä¸æ”¯æŒå¾ªç¯å¼•ç”¨ï¼Œä»è€Œå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚ä½ å¯ä»¥å…³é—­fastjsonçš„å¾ªç¯å¼•ç”¨æ”¯æŒã€‚å…³é—­å¼•ç”¨æ£€æµ‹ï¼Œè¿˜èƒ½å¤Ÿæå‡åºåˆ—åŒ–æ—¶çš„æ€§èƒ½ã€‚\nå…¨å±€é…ç½®å…³é—­\n1 JSON.DEFAULT_GENERATE_FEATURE |= SerializerFeature.DisableCircularReferenceDetect.getMask(); éå…¨å±€å…³é—­\n1 JSON.toJSONString(obj, SerializerFeature.DisableCircularReferenceDetect); é¡¹ç›®ä¸­é…ç½®äº†å…¨å±€é»˜è®¤ä½¿ç”¨fastjson, æ‰€ä»¥å¯¼è‡´é»˜è®¤çš„jacksonä¸ç”Ÿæ•ˆ. $ref-fastjson-è§£å†³æ–¹æ¡ˆ å…¨å±€é…ç½®å…³é—­\néå…¨å±€å…³é—­\nåˆ é™¤å…¨å±€é»˜è®¤fastjson\n","permalink":"https://habyss.github.io/posts/tech/ref-fastjson/","summary":"$ref-fastjson é—®é¢˜æ’æŸ¥ é—®é¢˜æ’æŸ¥ é¡¹ç›®è¿”å›çš„æ•°æ®ä¸­å‡ºç°$refæ•°æ® æŸ¥è¯¢å¾—çŸ¥æ˜¯fastjsonçš„ç‰¹æ€§å¾ªç¯å¼•ç”¨ fastjsonæ”¯æŒå¾ªç¯å¼•ç”¨ï¼Œå¹¶ä¸”æ˜¯ç¼ºçœæ‰“å¼€çš„ã€‚ å½“","title":"$ref-fastjsonæ’æŸ¥"},{"content":"SpringBootä¸­æ—¶é—´æˆ³å’ŒLocalDateTimeç›¸å…³çš„æ¥æ”¶å’Œè½¬æ¢ å‰è¨€ ä¸€èˆ¬æƒ…å†µä¸‹, å‰ç«¯å’Œåç«¯åœ¨æ—¶é—´æ ¼å¼çš„ä¼ é€’ä¸Šéƒ½èµ°çš„æ˜¯æ—¶é—´æˆ³ï¼ˆæ–¹ä¾¿å‰ç«¯è‡ªç”±å®šåˆ¶ï¼‰ æ—¶é—´æ ¼å¼ç”±äºjava8çš„æ–°å¢æ—¶é—´å¤„ç†ç±»æ¯”è¾ƒå¥½ç”¨,è€Œä¸”æ›´åŠ çº¿ç¨‹å®‰å…¨, æ‰€ä»¥å°†é¡¹ç›®ä¸­çš„æ—¶é—´ç›¸å…³æ”¹ä¸ºLocalDateTimeï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„Date å‰ç½®è¦æ±‚ mybatiséœ€è¦3.4.6ä»¥ä¸Š, å¦åˆ™ä¼šä¸æ”¯æŒxmlå’ŒjavaTypeçš„è½¬æ¢ druidéœ€è¦æ¯”è¾ƒæ–°çš„ç‰ˆæœ¬, è¿™é‡Œä½¿ç”¨çš„æ˜¯1.1.21, å¦åˆ™æŸ¥è¯¢ä¼šæŠ¥é”™,ç»“æœé›†result setä¸­æ‰¾ä¸åˆ°å…ƒç´  æ­£æ–‡ è¯·æ±‚æ–¹å¼çš„æƒ…å†µåˆ†ç±»\n@RequestBodyä¸­ä¿®é¥°LocalDateTime å…¶ä»–, æ¯”å¦‚@RequestParamå’Œ@PathVariableä»¥åŠä¸åŠ æ³¨è§£çš„å•å‚æ•°å’Œå¯¹è±¡å‚æ•° æƒ…å†µä¸€. @RequestBodyä¸­çš„LocalDateTime é€šè¿‡@RequestBodyå¾ˆæ˜æ˜¾çš„å°±æ˜¯è¦é€šè¿‡JSONåºåˆ—åŒ–è¿›è¡Œå¤„ç†ï¼ŒSpringé»˜è®¤çš„æ˜¯Jacksonè¿›è¡Œå¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹é»˜è®¤çš„JSONå¤„ç†å™¨è¿›è¡Œæ—¥æœŸç±»å‹çš„æ·»åŠ (å‡å¦‚é»˜è®¤ä¸å¸¦å¯¹åº”åºåˆ—åŒ–å™¨çš„æƒ…å†µä¸‹)\næ­¤æ—¶éœ€è¦ç”¨çš„æ˜¯JsonDeserializerè¿™ä¸ªç±»ï¼Œå¯¹åº”çš„å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 /** * å…¥å‚ æ—¶é—´æˆ³ -\u0026gt; LocalDateTime */ public class CustomDateDeserializer { public static class LocalDateTimeDeserializer extends JsonDeserializer\u0026lt;LocalDateTime\u0026gt; { @Override public LocalDateTime deserialize(JsonParser p, DeserializationContext context) throws IOException { Long timestamp = Long.valueOf(p.getText()); Instant instant = Instant.ofEpochMilli(timestamp); return LocalDateTime.ofInstant(instant, ZoneId.systemDefault()); } } } /** * @author kun.han on 2020/3/4 15:45 * è¿”å›å‚æ•° LocalDateTime -\u0026gt; æ—¶é—´æˆ³ */ public class CustomDateSerializer { public static class LocalDateTimeSerializer extends JsonSerializer\u0026lt;LocalDateTime\u0026gt; { @Override public void serialize(LocalDateTime localDateTime, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) throws IOException { jsonGenerator.writeNumber(localDateTime.toInstant(ZoneOffset.of(\u0026#34;+8\u0026#34;)).toEpochMilli()); } } } æœ‰äº†è¿™ä¸ªäº†ç±»ï¼Œè¿˜éœ€è¦æ·»åŠ åˆ°Springä¸­ï¼ŒSpringåˆ©ç”¨çš„æ˜¯ObjectMapperï¼Œæˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªObjectMapperæ›¿æ¢åŸæœ¬çš„å°±å¯ä»¥äº†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 @Configuration public class CustomDateConfig implements WebMvcConfigurer { /** * Jsonåºåˆ—åŒ–å’Œååºåˆ—åŒ–è½¬æ¢å™¨ï¼Œç”¨äºè½¬æ¢Postè¯·æ±‚ä½“ä¸­çš„jsonä»¥åŠå°†æˆ‘ä»¬çš„å¯¹è±¡åºåˆ—åŒ–ä¸ºè¿”å›å“åº”çš„json */ @Bean public ObjectMapper objectMapper() { ObjectMapper objectMapper = new ObjectMapper(); //ä¸æ˜¾ç¤ºä¸ºnullçš„å­—æ®µ objectMapper.disable(SerializationFeature.FAIL_ON_EMPTY_BEANS); objectMapper.disable(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES); // å¿½ç•¥ä¸èƒ½è½¬ç§»çš„å­—ç¬¦ objectMapper.configure(JsonParser.Feature.ALLOW_BACKSLASH_ESCAPING_ANY_CHARACTER, true); // è¿‡æ»¤å¯¹è±¡çš„nullå±æ€§. objectMapper.setSerializationInclusion(JsonInclude.Include.NON_NULL); //å¿½ç•¥transient objectMapper.configure(MapperFeature.PROPAGATE_TRANSIENT_MARKER, true); objectMapper.disable(DeserializationFeature.ADJUST_DATES_TO_CONTEXT_TIME_ZONE); //LocalDateTimeç³»åˆ—åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ¨¡å—ï¼Œç»§æ‰¿è‡ªjsr310ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä¿®æ”¹äº†æ—¥æœŸæ ¼å¼ JavaTimeModule javaTimeModule = new JavaTimeModule(); // LocalDateTime è¿™é‡Œåªéœ€è¦LocalDateTime å¦‚æœéœ€è¦è½¬å…¶ä»–çš„,ç›¸åº”æ”¾å¼€æ³¨é‡Š, å¹¶åœ¨ä¸Šé¢ä¸¤ä¸ªç±»ä¸­é€‚å½“ä¿®æ”¹ javaTimeModule.addSerializer(LocalDateTime.class, new CustomDateSerializer.LocalDateTimeSerializer()); javaTimeModule.addDeserializer(LocalDateTime.class,new CustomDateDeserializer.LocalDateTimeDeserializer()); // // LocalDate // javaTimeModule.addSerializer(LocalDate.class, new CustomDateSerializer.LocalDateSerializer()); // javaTimeModule.addDeserializer(LocalDate.class, new CustomDateDeserializer.LocalDateDeserializer()); // //Dateåºåˆ—åŒ–å’Œååºåˆ—åŒ– // javaTimeModule.addSerializer(Date.class,new CustomDateSerializer.DateSerializer()); // javaTimeModule.addDeserializer(Date.class,new CustomDateDeserializer.DateDeserializer()); objectMapper.registerModule(javaTimeModule); return objectMapper; } } æƒ…å†µäºŒ. å…¶ä»– æ¯”å¦‚@RequestParamå’Œ@PathVariableä»¥åŠä¸åŠ æ³¨è§£çš„å•å‚æ•°å’Œå¯¹è±¡å‚æ•° æ–¹å¼ä¸€: Convert å¯ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚è¿›è¡Œå®šåˆ¶ï¼Œè¿™é‡Œæˆ‘é€šè¿‡Convertè½¬æ¢LocalDateTimeä¸ºä¾‹ï¼Œè¿›è¡Œè½¬æ¢ï¼š\n1 2 3 4 5 6 7 8 9 public class CustomDateConverter { public static class LocalDateConvert implements Converter\u0026lt;String, LocalDateTime\u0026gt; { @Override public LocalDateTime convert(String timestamp) { return LocalDateTime.ofInstant(Instant.ofEpochMilli(Long.parseLong(timestamp)), ZoneId.systemDefault()); } } } åŒæ ·çš„éœ€è¦åœ¨é…ç½®ç±»ä¸­å¼•ç”¨\n1 2 3 4 5 6 7 8 @Configuration public class CustomDateConfig implements WebMvcConfigurer { @Bean public Converter\u0026lt;String, LocalDateTime\u0026gt; localDateConverter() { //æ­¤å¤„ä¸èƒ½æ›¿æ¢ä¸ºlambdaè¡¨è¾¾å¼ return new CustomDateConverter.LocalDateConvert(); } } æ–¹å¼äºŒ: ControllerAdvice 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 /** * requestBodyä¹‹å¤–çš„å…¥å‚ æ—¶é—´æˆ³-\u0026gt;LocalDateTime * * @author hankun */ @ControllerAdvice public class LocalDateTimeAdvice { @InitBinder protected void initBinder(WebDataBinder binder) { // è¿™é‡Œåªéœ€è¦LocalDateTime å¦‚æœéœ€è¦è½¬å…¶ä»–çš„,ç›¸åº”æ·»åŠ /ä¿®æ”¹ binder.registerCustomEditor(LocalDateTime.class, new PropertyEditorSupport() { @Override public void setAsText(String timestamp) throws IllegalArgumentException { if (!StringUtils.hasText(timestamp)) { setValue(null); } else { setValue(LocalDateTime.ofInstant(Instant.ofEpochMilli(Long.parseLong(timestamp)), ZoneId.systemDefault())); } } }); // è¿™é‡Œåªéœ€è¦LocalDateTime å¦‚æœéœ€è¦è½¬å…¶ä»–çš„,ç›¸åº”æ·»åŠ /ä¿®æ”¹ binder.registerCustomEditor(LocalDate.class, new PropertyEditorSupport() { @Override public void setAsText(String timestamp) throws IllegalArgumentException { if (!StringUtils.hasText(timestamp)) { setValue(null); } else { setValue(LocalDate.ofInstant(Instant.ofEpochMilli(Long.parseLong(timestamp)), ZoneId.systemDefault())); } } }); } } ç›¸å…³çŸ¥è¯†ç‚¹ æ—¶é—´å·® ç²¾ç¡®æ—¶é—´å·®:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 long start = 1584328558000L; long now = 1584400558000L; Instant startTime = Instant.ofEpochMilli(start); LocalDateTime startTimeT = LocalDateTime.ofInstant(startTime, ZoneId.systemDefault()); Instant endTime = Instant.ofEpochMilli(now); LocalDateTime entTimeT = LocalDateTime.ofInstant(startTime, ZoneId.systemDefault()); Duration duration = Duration.between(startTimeT, entTimeT); // Duration duration = Duration.between(startTime, entTime); long day = duration.toDays(); long hours = duration.toHours(); long min = duration.toMinutes(); long millis= duration.toMillis(); long nanos = duration.toNanos(); ç²—ç•¥æ—¶é—´å·®, æ¯”å¦‚ä»Šå¤©æ˜å¤©ç®—ä¸€å¤©\n1 2 3 4 5 6 7 8 9 10 11 long start = 1584328558000L; long now = 1584400558000L; Instant startTime = Instant.ofEpochMilli(start); LocalDate startTimeT = LocalDateTime.ofInstant(startTime, ZoneId.systemDefault()).toLocalDate(); Instant endTime = Instant.ofEpochMilli(now); LocalDate entTimeT = LocalDateTime.ofInstant(startTime, ZoneId.systemDefault()).toLocalDate(); Period period = Period.between(startTimeT, entTimeT); int years = period.getYears(); int months = period.getMonths(); int days = period.getDays(); ","permalink":"https://habyss.github.io/posts/tech/springboot_localdatetime/","summary":"SpringBootä¸­æ—¶é—´æˆ³å’ŒLocalDateTimeç›¸å…³çš„æ¥æ”¶å’Œè½¬æ¢ å‰è¨€ ä¸€èˆ¬æƒ…å†µä¸‹, å‰ç«¯å’Œåç«¯åœ¨æ—¶é—´æ ¼å¼çš„ä¼ é€’ä¸Šéƒ½èµ°çš„æ˜¯æ—¶é—´æˆ³ï¼ˆæ–¹ä¾¿å‰ç«¯","title":"SpringBootä¸­æ—¶é—´æˆ³å’ŒLocalDateTimeç›¸å…³çš„æ¥æ”¶å’Œè½¬æ¢"},{"content":"å°é¹¤åŒæ‹¼ æ–¹æ¡ˆä¸€ win + Rï¼Œè¾“å…¥ regeditï¼Œæ‰“å¼€æ³¨å†Œè¡¨\næ‰¾åˆ° è®¡ç®—æœº\\HKEY_CURRENT_USER\\Software\\Microsoft\\InputMethod\\Settings\\CHS é¡¹\næ–°å»ºä¸€ä¸ªåä¸º UserDefinedDoublePinyinScheme0 çš„å­—ç¬¦ä¸²å€¼ï¼Œå€¼ä¸º\n1 å°é¹¤åŒæ‹¼*2*^*iuvdjhcwfg^xmlnpbksqszxkrltvyovt æ–¹æ¡ˆäºŒ æ–°å»ºæ–‡æœ¬æ–‡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\InputMethod\\Settings\\CHS] \u0026#34;EnableExtraDomainType\u0026#34;=dword:00000001 \u0026#34;EnableSmartSelfLearning\u0026#34;=dword:00000000 \u0026#34;EnableVMode\u0026#34;=dword:00000000 \u0026#34;EnableHap\u0026#34;=dword:00000000 \u0026#34;EnablePeopleName\u0026#34;=dword:00000000 \u0026#34;DoublePinyinScheme\u0026#34;=dword:0000000a \u0026#34;EnableUMode\u0026#34;=dword:00000000 \u0026#34;EnableSmartFuzzyPinyin\u0026#34;=dword:00000000 \u0026#34;UserDefinedDoublePinyinScheme0\u0026#34;=\u0026#34;å°é¹¤åŒæ‹¼*2*^*iuvdjhcwfg^xmlnpbksqszxkrltvyovt\u0026#34; \u0026#34;Enable Dynamic Candidate Ranking\u0026#34;=dword:00000000 \u0026#34;Enable self-learning\u0026#34;=dword:00000000 \u0026#34;Expand Double Pinyin\u0026#34;=dword:00000000 \u0026#34;Enable Double Pinyin\u0026#34;=dword:00000001 \u0026#34;LangBar Force On\u0026#34;=dword:00000000 \u0026#34;PinyinMixEnable\u0026#34;=dword:00000000 \u0026#34;ToolBarEnabled\u0026#34;=dword:00000000 é‡å‘½å.reg, å¹¶è¿è¡Œ\n","permalink":"https://habyss.github.io/posts/tool/%E5%B0%8F%E9%B9%A4%E5%8F%8C%E6%8B%BC/","summary":"å°é¹¤åŒæ‹¼ æ–¹æ¡ˆä¸€ win + Rï¼Œè¾“å…¥ regeditï¼Œæ‰“å¼€æ³¨å†Œè¡¨ æ‰¾åˆ° è®¡ç®—æœº\\HKEY_CURRENT_USER\\Software\\Microsoft\\I","title":"å°é¹¤åŒæ‹¼"},{"content":"Mysql-explain id idç›¸åŒæ—¶, æ‰§è¡Œé¡ºåºç”±ä¸Šè€Œä¸‹ idä¸åŒæ—¶, æ‰§è¡Œé¡ºåºç”±å¤§åˆ°å°, ä¸€èˆ¬ä¸ºå­æŸ¥è¯¢ select_type æŸ¥è¯¢ç±»å‹, å¸¸è§çš„å€¼æœ‰:\nSIMPLE: ç®€å•æŸ¥è¯¢, ä¸åŒ…å«UNIONæˆ–è€…å­æŸ¥è¯¢ PRIMARY: æŸ¥è¯¢ä¸­å¦‚æœåŒ…å«å­æŸ¥è¯¢æˆ–å…¶ä»–éƒ¨åˆ†, åˆ™å¤–å±‚çš„SELECTå°†è¢«æ ‡è®°ä¸ºPRIMARY SUBQUERY: å­æŸ¥è¯¢ä¸­çš„ç¬¬ä¸€ä¸ªSELECT NUION: åœ¨UNIONè¯­å¥ä¸­, UNIONä¹‹åå‡ºç°çš„SELECT DERIVED: åœ¨FROMä¸­å‡ºç°çš„å­æŸ¥è¯¢ UNION RESULT: UNIONæŸ¥è¯¢çš„ç»“æœ table å½“å‰çš„æ•°æ®è¡¨\npartitions æŸ¥è¯¢æ‰€åŒ¹é…è®°å½•çš„åˆ†åŒº, å¯¹äºæœªåˆ†åŒºçš„è¡¨, å€¼ä¸ºNULL\ntype æŸ¥è¯¢æ‰§è¡Œçš„ç±»å‹, æœ€ä¼˜æ’è¡Œ\nsystem \u0026gt; const \u0026gt; eq_ref \u0026gt; ref \u0026gt; fulltext \u0026gt; ref_or_null \u0026gt; index_merge \u0026gt; unique_subquery \u0026gt; index_subquery \u0026gt; range \u0026gt; index \u0026gt; ALL\nsystem: è¡¨ä¸­åªæœ‰ä¸€è¡Œæ•°æ®, æ˜¯constçš„ä¸€ç§ç‰¹ä¾‹ const: è¡¨ä¸­æœ€å¤šåªæœ‰ä¸€è¡ŒåŒ¹é…çš„è®°å½• eq_ref: è¿è¡¨æŸ¥è¯¢æ—¶, å‰ä¸€å¼ è¡¨çš„è¡Œåœ¨å½“å‰è¡¨ä¸­åªæœ‰ä¸€è¡Œä¸ä¹‹å¯¹åº”(é™¤äº†systemä¸constæœ€å¥½çš„è¿è¡¨æ–¹å¼) ref: ä½¿ç”¨æ™®é€šç´¢å¼•ä½œä¸ºæŸ¥è¯¢æ¡ä»¶, æŸ¥è¯¢ç»“æœå¯èƒ½æ‰¾åˆ°å¤šè¡ŒåŒ¹é…çš„è®°å½• fulltext: å…¨æ–‡ç´¢å¼• ref_or_null: ä½¿ç”¨æ™®é€šç´¢å¼•ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ , æŸ¥è¯¢ç»“æœå¯èƒ½æ‰¾åˆ°å¤šè¡ŒåŒ¹é…çš„è®°å½•, è¿˜æŸ¥è¯¢äº†å€¼ä¸ºNULLçš„è¡Œ index_merge: å½“æŸ¥è¯¢æ¡ä»¶ä½¿ç”¨å¤šä¸ªç´¢å¼•æ—¶, index_mergeè¡¨ç¤ºå¼€å¯äº†Index Mergeä¼˜åŒ– unique_subquery: eq_refç±»ä¼¼, åœ¨ä¸€äº›ä½¿ç”¨INçš„å­æŸ¥è¯¢ä¸­, ä½¿ç”¨å”¯ä¸€ç´¢å¼• index_subquery: ä¸unique_subqueryç±»ä¼¼, åœ¨INå­æŸ¥è¯¢ä¸­, ä½¿ç”¨äº†æ™®é€šç´¢å¼• range: å¯¹ç´¢å¼•åˆ—è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ index: æŸ¥è¯¢ä¾¿åˆ©äº†æ•´ä¸ªç´¢å¼•æ ‘, ALL: éå†å…¨è¡¨, å¾ˆå¯èƒ½è¯»ç£ç›˜, é€Ÿåº¦æœ€æ…¢ possible_key å¯èƒ½è¢«ä½¿ç”¨çš„ç´¢å¼•, ä¸ä¸€å®šè¢«æŸ¥è¯¢å®é™…ä½¿ç”¨\nkey æŸ¥è¯¢ä¸­å®é™…ä½¿ç”¨åˆ°çš„ç´¢å¼•, å¦‚æœä¸ºNULL, åˆ™è¡¨ç¤ºä¸ºå»ºç«‹ç´¢å¼•æˆ–ç´¢å¼•å¤±æ•ˆ\nkey_len æŸ¥è¯¢ç´¢å¼•æ—¶ä½¿ç”¨çš„å­—èŠ‚æ•°, åœ¨æ»¡è¶³å‰æçš„éœ€æ±‚ä¸‹, è¶Šå°è¶Šå¥½\nref åœ¨æŸ¥è¯¢ç´¢å¼•æ—¶, é‚£äº›åˆ—æˆ–å¸¸é‡è¢«ç”¨æ¥ä¸ç´¢å¼•å€¼æ¯”è¾ƒ\nrows å¯èƒ½æŸ¥è¯¢æ—¶éœ€è¦éå†çš„è¡Œæ•°\nfiltered ä¼°ç®—ç»è¿‡æŸ¥è¯¢æ¡ä»¶ç­›é€‰å‡ºçš„åˆ—æ•°çš„ç™¾åˆ†æ¯”\nExtra æŸ¥è¯¢æ—¶çš„é¢å¤–ä¿¡æ¯\nå½“åŒ…å«Using filesortæˆ–Using temporary, éœ€è¦ä¼˜åŒ–\nUsing filesort: åœ¨æ’åºæ—¶ä½¿ç”¨äº†å¤–éƒ¨çš„ç´¢å¼•æ’åº, æ²¡æœ‰ä½¿ç”¨è¡¨å†…çš„ç´¢å¼•è¿›è¡Œæ’åº Using temporary: éœ€è¦åˆ›å»ºä¸´æ—¶è¡¨æ¥å­˜å‚¨æŸ¥è¯¢çš„ç»“æœ, å¸¸è§äºORDER BYå’ŒGROUP BY Using index: ä½¿ç”¨äº†ç´¢å¼•è¦†ç›–, æŸ¥è¯¢æ•ˆç‡éå¸¸é«˜ Using where: ä½¿ç”¨äº†WHEREå­å¥è¿›è¡Œæ¡ä»¶è¿‡æ»¤, ä¸€èˆ¬åœ¨æ²¡æœ‰ä½¿ç”¨åˆ°ç´¢å¼•çš„æ—¶å€™å‡ºç° Impossible where: è¡¨ç¤ºwhereå­å¥çš„ç»“æœæ€»æ˜¯falseä¸”æ— æ³•æŸ¥åˆ°ä»»æ„è¡Œ Using join buffer(Block Nested Loop): è¿è¡¨æŸ¥è¯¢æ—¶, å½“è¢«é©±åŠ¨è¡¨æ²¡æœ‰ä½¿ç”¨ç´¢å¼•æ—¶, ä¼šå…ˆå°†é©±åŠ¨è¡¨è¯»åˆ°join bufferä¸­, å†éå†è¢«é©±åŠ¨è¡¨ä¸é©±åŠ¨è¡¨è¿›è¡ŒæŸ¥è¯¢ Using json buffer(Batched Key Access): ä¸Using join buffer(Block Nested Loop)ç±»ä¼¼, ä½¿ç”¨çš„æ˜¯BKAç®—æ³•\u0026ndash; å‰ææ˜¯è¢«é©±åŠ¨è¡¨æœ‰ç´¢å¼•å¯ç”¨ ","permalink":"https://habyss.github.io/posts/tech/mysql_explain/","summary":"Mysql-explain id idç›¸åŒæ—¶, æ‰§è¡Œé¡ºåºç”±ä¸Šè€Œä¸‹ idä¸åŒæ—¶, æ‰§è¡Œé¡ºåºç”±å¤§åˆ°å°, ä¸€èˆ¬ä¸ºå­æŸ¥è¯¢ select_type æŸ¥è¯¢ç±»å‹, å¸¸è§çš„å€¼æœ‰: SIMPLE: ç®€å•æŸ¥è¯¢, ä¸åŒ…å«UNIONæˆ–è€…å­æŸ¥è¯¢ PRIMARY: æŸ¥","title":"Mysql Explain ç®€è§£"},{"content":"Hugo+Github Pages 1. å®‰è£…Scoop winç³»ç»Ÿ, åœ¨hugoå®˜ç½‘ä¸­ä¹Ÿæ¨èäº†ä½¿ç”¨Scoopæ¥è¿›è¡ŒåŒ…ç®¡ç†\næ‰“å¼€PowerShellå¹¶è¿è¡Œ, ä¿è¯å…è®¸æœ¬åœ°è„šæœ¬çš„æ‰§è¡Œ\n1 set-executionpolicy remotesigned -scope currentuser æ‰§è¡Œå®‰è£…å‘½ä»¤\n1 iex (new-object net.webclient).downloadstring(\u0026#39;https://get.scoop.sh\u0026#39;) å®‰è£…æˆåŠŸéªŒè¯\n1 scoop help 2. å®‰è£…Hugo å®‰è£…Hugoçš„extendç‰ˆæœ¬\n1 scoop install hugo-extended å®‰è£…æˆåŠŸéªŒè¯\n1 hugo version 3. åˆ›å»ºBlog hugo new site MyBlog -f yml ä¸‹è½½zipè§£å‹åˆ°themes, å¹¶é‡å‘½åä¸ºPaperMod ä¿®æ”¹config.yml https://shaohanyun.top/posts/env/blog_build2/\nhttps://www.sulvblog.cn/posts/blog/build_hugo/\n","permalink":"https://habyss.github.io/posts/tech/%E6%B5%8B%E8%AF%95/","summary":"Hugo+Github Pages 1. å®‰è£…Scoop winç³»ç»Ÿ, åœ¨hugoå®˜ç½‘ä¸­ä¹Ÿæ¨èäº†ä½¿ç”¨Scoopæ¥è¿›è¡ŒåŒ…ç®¡ç† æ‰“å¼€PowerShellå¹¶è¿è¡Œ, ä¿è¯å…è®¸æœ¬åœ°è„šæœ¬çš„æ‰§è¡Œ 1 set-executionpolicy","title":"æµ‹è¯•"}]